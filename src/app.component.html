 @if (isLoading()) {
  <app-splash-screen />
} @else {
  @if (currentUser()) {
    <!-- Mobile-First App View (User is Logged In) -->
    <div class="min-h-screen bg-[var(--bg-color)] pb-24"> <!-- Padding for bottom nav -->
      
      <!-- Top Header -->
      <header class="bg-[var(--card-color)]/80 backdrop-blur-sm sticky top-0 shadow-sm h-16 flex items-center justify-between px-4 z-20">
        <h1 class="text-2xl font-bold text-[var(--accent-color)]">{{ currentViewName() }}</h1>
        <button (click)="logout()" class="p-2 rounded-full text-2xl hover:bg-[var(--card-bg-hover)] transition-colors" title="Sair">
            ðŸšª
        </button>
      </header>
      
      <!-- Main Content -->
      <main class="p-4 sm:p-6">
        <div class="max-w-7xl mx-auto">
          @switch (activeView()) {
            @case ('dashboard') {
              <app-dashboard (viewChange)="setView($event)" />
            }
            @case ('pricing') {
              <app-pricing />
            }
            @case ('products') {
              <app-products />
            }
            @case ('orders') {
              <app-orders />
            }
            @case ('customers') {
              <app-customers />
            }
            @case ('inventory') {
              <app-inventory />
            }
            @case ('reports') {
              <app-reports />
            }
            @case ('settings') {
              <app-settings />
            }
          }
        </div>
      </main>

      <!-- Bottom Navigation Bar -->
      <nav class="fixed bottom-0 left-0 right-0 h-20 bg-[var(--card-color)] border-t border-[var(--input-border-color)] shadow-[0_-2px_10px_rgba(0,0,0,0.05)] flex justify-around items-center z-30">
        @for (item of menuItems; track item.id) {
          <button (click)="setView(item.id)" 
                  [class]="'flex flex-col items-center justify-center w-full h-full transition-colors duration-200 pt-2 pb-1 ' + (activeView() === item.id ? 'text-[var(--accent-color)]' : 'text-[var(--secondary-color)] hover:text-[var(--accent-color)]')">
            <span class="text-3xl mb-1">{{ item.icon }}</span>
            <span class="text-xs" [class]="activeView() === item.id ? 'font-bold' : ''">
              {{ item.name }}
            </span>
          </button>
        }
      </nav>
    </div>
  } @else {
    <!-- Auth View (User is Logged Out) -->
    <div class="relative min-h-screen bg-[var(--bg-color)] flex flex-col items-center p-4 overflow-hidden">
      <!-- Wavy Background -->
      <div class="absolute bottom-0 left-0 w-full z-0 pointer-events-none opacity-90">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1440 320">
            <defs>
                <linearGradient id="waveGradient" x1="0.5" y1="0" x2="0.5" y2="1">
                    <stop offset="0%" stop-color="#F9C6D3" />
                    <stop offset="100%" stop-color="#E94E77" />
                </linearGradient>
            </defs>
            <path fill="url(#waveGradient)" d="M0,224L48,208C96,192,192,160,288,165.3C384,171,480,213,576,208C672,203,768,149,864,149.3C960,149,1056,203,1152,224C1248,245,1344,235,1392,229.3L1440,224L1440,320L1392,320C1344,320,1248,320,1152,320C1056,320,960,320,864,320C768,320,672,320,576,320C480,320,384,320,288,320C192,320,96,320,48,320L0,320Z"></path>
        </svg>
      </div>
      
      <!-- Auth Content -->
      <div class="relative z-10 w-full flex-grow flex flex-col justify-center items-center pb-20">
        @switch (activeView()) {
          @case ('login') {
            <app-login (navigate)="setView($event)" />
          }
          @case ('signup') {
            <app-signup (navigate)="setView($event)" />
          }
          @case ('reset-password') {
            <app-reset-password (navigate)="setView($event)" />
          }
        }
      </div>
    </div>
  }
}